<Page x:Class="Gomoku_Client.View.Matchmaking"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Gomoku_Client.View"
      mc:Ignorable="d" 
      d:DesignHeight="720" d:DesignWidth="1280"
      Title="Matchmaking"
      Loaded="Page_Loaded"
      Unloaded="Page_Unloaded">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <Storyboard x:Key="MovingDotStoryboard" RepeatBehavior="Forever">
                <!-- main dot -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DotTranslateTransform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.75" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.5" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.25" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="0"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DotTranslateTransform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.75" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.5" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.25" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-34"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 1 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail1Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-2.27"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.05" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.8" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.55" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.3" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-2.27"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail1Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-31.73"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.05" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.8" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.55" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.3" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-31.73"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 2 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail2Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-4.53"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.1" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.85" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.6" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.35" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-4.53"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail2Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-29.47"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.1" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.85" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.6" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.35" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-29.47"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 3 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail3Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-6.8"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.15" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.9" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.65" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.4" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-6.8"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail3Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-27.2"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.15" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.65" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.4" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-27.2"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 4 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail4Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-9.07"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.95" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.7" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.45" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-9.07"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail4Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-24.93"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.2" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.95" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.7" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.45" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-24.93"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 5 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail5Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-11.33"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.25" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.75" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.5" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-11.33"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail5Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-22.67"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.25" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.75" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.5" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-22.67"/>
                </DoubleAnimationUsingKeyFrames>

                <!-- trail 6 -->
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail6Transform" 
                                   Storyboard.TargetProperty="X"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-13.6"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.3" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.05" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.8" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.55" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-13.6"/>
                </DoubleAnimationUsingKeyFrames>
                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trail6Transform" 
                                   Storyboard.TargetProperty="Y"
                                   RepeatBehavior="Forever">
                    <SplineDoubleKeyFrame KeyTime="0:0:0" Value="-20.4"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:0.3" Value="-34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.05" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:1.8" Value="34"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:2.55" Value="0"/>
                    <SplineDoubleKeyFrame KeyTime="0:0:3" Value="-20.4"/>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>
        </ResourceDictionary>
    </Page.Resources>

    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0F1923" Offset="0"/>
                <GradientStop Color="#152635" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>

        <!-- top bar -->
        <Border Height="60" VerticalAlignment="Top" Background="Transparent" Panel.ZIndex="1">
            <Border.Effect>
                <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="3" Opacity="0.5"/>
            </Border.Effect>
            <Grid>
                <RadioButton x:Name="BackButton" 
                         Content="Quay lại" 
                         Style="{StaticResource BackButton}" 
                         Checked="BackButton_Checked"/>
            </Grid>
        </Border>

        <!-- main area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- divider -->
            <Canvas>
                <Line X1="700" Y1="0" X2="580" Y2="725" Stroke="White" StrokeThickness="20"
                      Panel.ZIndex="0" Opacity="0.15" HorizontalAlignment="Center" Height="725" VerticalAlignment="Top">
                    <Line.Effect>
                        <DropShadowEffect Color="#FFFFFF" BlurRadius="15" ShadowDepth="0" Opacity="0.3"/>
                    </Line.Effect>
                </Line>
            </Canvas>

            <!-- left (local player) -->
            <Grid Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border Width="300" Height="350" CornerRadius="0" BorderBrush="#FF4655" BorderThickness="3" HorizontalAlignment="Center">
                    <Border.Effect>
                        <DropShadowEffect Color="#FF4655" BlurRadius="25" ShadowDepth="0" Opacity="0.6"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="0" Background="#2A2E3A">
                            <Image x:Name="img_PlayerAvatar" Source="/Assets/T1_6sao.jpg" VerticalAlignment="Top"/>
                        </Border>
                        <Border VerticalAlignment="Bottom" Height="140" CornerRadius="0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="Transparent" Offset="0"/>
                                    <GradientStop Color="#80000000" Offset="0.5"/>
                                    <GradientStop Color="#DD000000" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <StackPanel VerticalAlignment="Bottom" Margin="20,0,20,20">
                                <TextBlock x:Name="tb_PlayerName" Text="PLAYER" FontSize="20" FontWeight="Bold" Foreground="#FFFFFF" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                                    <TextBlock Text="🎮" FontSize="20" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#FFFFFF"/>
                                    <TextBlock x:Name="lb_matches" Text="0" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFFF" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                    <TextBlock Text="trận" FontSize="16" FontWeight="SemiBold" Foreground="#9FA3A9" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="👑" FontSize="24" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#FFFFFF"/>
                                    <TextBlock x:Name="tb_WinRate" Text="0%" FontSize="18" FontWeight="SemiBold" Foreground="#FFFFFF" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
            </Grid>

            <!-- right (matchmaking info) [queue timer/opponent info) -->
            <Grid Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel x:Name="sp_FindingOpponent" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- loading icon -->
                    <Grid x:Name="grid_LoadingIcon" Width="120" Height="120" Margin="0,0,0,40">
                        <Border x:Name="DiamondBorder"
                            Width="80" Height="80"
                            BorderThickness="4"
                            Background="Black"
                            RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <RotateTransform Angle="45"/>
                            </Border.RenderTransform>
                        </Border>

                        <!-- trail -->
                        <Ellipse Width="7" Height="7" Fill="#FF4655" Opacity="0.15"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail6Transform" X="-13.6" Y="-20.4"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <Ellipse Width="7" Height="7" Fill="#FF4655" Opacity="0.25"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail5Transform" X="-11.33" Y="-22.67"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <Ellipse Width="7" Height="7" Fill="#FF4655" Opacity="0.35"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail4Transform" X="-9.07" Y="-24.93"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <Ellipse Width="8" Height="8" Fill="#FF4655" Opacity="0.45"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail3Transform" X="-6.8" Y="-27.2"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <Ellipse Width="8" Height="8" Fill="#FF4655" Opacity="0.6"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail2Transform" X="-4.53" Y="-29.47"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <Ellipse Width="9" Height="9" Fill="#FF4655" Opacity="0.75"
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="Trail1Transform" X="-2.27" Y="-31.73"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>

                        <!-- main dot -->
                        <Ellipse Width="10" Height="10" Fill="#FF4655"
                            HorizontalAlignment="Center" VerticalAlignment="Center"
                            RenderTransformOrigin="0.5,0.5">
                            <Ellipse.Effect>
                                <DropShadowEffect Color="#FF4655" BlurRadius="15" ShadowDepth="0" Opacity="1"/>
                            </Ellipse.Effect>
                            <Ellipse.RenderTransform>
                                <TranslateTransform x:Name="DotTranslateTransform" X="0" Y="-34"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>
                    </Grid>

                    <!-- finding text -->
                    <TextBlock Text="ĐANG TÌM ĐỐI THỦ" 
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#FFFFFF" 
                               HorizontalAlignment="Center"/>

                    <!-- timer -->
                    <TextBlock x:Name="tb_QueueTime"
                               Text="00:00" 
                               FontSize="20" 
                               Foreground="#9FA3A9" 
                               HorizontalAlignment="Center"
                               Margin="0,10,0,0"/>
                </StackPanel>
                <!-- opponent info -->
                <Grid x:Name="grid_OpponentFound" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed">
                    <Border Width="300" Height="350" CornerRadius="0" BorderBrush="#4CAF50" BorderThickness="3" HorizontalAlignment="Center">
                        <Border.Effect>
                            <DropShadowEffect Color="#4CAF50" BlurRadius="25" ShadowDepth="0" Opacity="0.6"/>
                        </Border.Effect>
                        <Grid>
                            <Border CornerRadius="0" Background="#2A2E3A">
                                <Image x:Name="img_OpponentAvatar" Source="/Assets/default_avatar.png" Stretch="UniformToFill" VerticalAlignment="Top"/>
                            </Border>
                            <Border VerticalAlignment="Bottom" Height="140" CornerRadius="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="Transparent" Offset="0"/>
                                        <GradientStop Color="#80000000" Offset="0.5"/>
                                        <GradientStop Color="#DD000000" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel VerticalAlignment="Bottom" Margin="20,0,20,20">
                                    <TextBlock x:Name="tb_OpponentName" Text="OPPONENT" FontSize="20" FontWeight="Bold" Foreground="#FFFFFF" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                                        <TextBlock Text="🎮" FontSize="20" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#FFFFFF"/>
                                        <TextBlock x:Name="lb_OpponentMatches" Text="0" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFFF" VerticalAlignment="Center" Margin="0,0,4,0"/>
                                        <TextBlock Text="trận" FontSize="16" FontWeight="SemiBold" Foreground="#9FA3A9" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="👑" FontSize="24" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#FFFFFF"/>
                                        <TextBlock x:Name="tb_OpponentWinRate" Text="0%" FontSize="18" FontWeight="SemiBold" Foreground="#FFFFFF" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
            
        </Grid>
    </Grid>
</Page>